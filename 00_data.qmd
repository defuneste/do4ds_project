---
title: "Penguins Data ETL (DuckDB database)"
execute:
    echo: true
    output: true
    message: false
    warning: false
format:
    html:
        code-fold: true
---

```{python}
import duckdb
from palmerpenguins import penguins

con = duckdb.connect('data/my-db.duckdb')
df = penguins.load_penguins()
con.execute('CREATE OR REPLACE TABLE penguins AS SELECT * FROM df')
con.close()
```

```{r}
#| label: Write data to duckdb file
con <- DBI::dbConnect(duckdb::duckdb(), dbdir = "data/my-db.duckdb")
DBI::dbWriteTable(con, "penguins", palmerpenguins::penguins, overwrite=TRUE)
```

```{r}
#| label: Write data to json file
duckdb::dbSendQuery(con, "INSTALL json;")
duckdb::dbSendQuery(con, "LOAD json;")
duckdb::dbSendQuery(con, "COPY penguins TO './data/penguins.json' (ARRAY true);")
DBI::dbDisconnect(con)
```

